---
title: "individual1"
author: "Rabsa Naseer"
date: "11/6/2020"
output: html_document
---

```{r}
acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
acc
pers <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
pers
library(tidyverse)
make <- readr::read_csv("makeCodes.xls")%>%
  rename("STATE" = "Codes")
make
state <- readr::read_csv("stateCodes.xls") %>%
  rename("STATE" = "Codes")
acc2 <- right_join(state, acc)
acc_final <- right_join(make, acc2)
##acc_final <- right_join(day, acc3)
acc_final
pers2 <- right_join(make, pers)
pers_final <- right_join(state, pers2)
pers_final

```

1. 
```{r}
table(acc$DAY_WEEK)
```

2.
```{r}
hurt <- pers_final[pers_final$INJ_SEV == 4,]
hurt
```
3.
```{r}
col <- pers_final[, c("INJ_SEV", "MAKE", "Make", "STATE","State")]
danger <- col %>%
  filter(INJ_SEV == 4) %>%
  group_by(STATE, State, MAKE, Make) %>%
  summarize(n = n()) %>%
  group_by(STATE) %>%
  filter(n == max(n)) %>%
  filter(is.na(MAKE) == FALSE) %>%
  arrange(desc(n))
danger
```
4.
```{r}
codes<- readxl::read_xlsx("FRPP_GLC_-_United_StatesSep292020.xlsx")
codes <- codes[, c("State Name", "State Code", "County Code", "County Name")] %>%
  rename("STATE" = "State Code")
codes
codes$STATE <- as.numeric(codes$STATE)

```

