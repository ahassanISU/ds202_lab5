---
title: "team"
author: "Rabsa Naseer"
date: "11/9/2020"
output: html_document
---

```{r}
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyverse)
library(lubridate)
library(ggrepel)

acc <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/accident.csv", stringsAsFactors = FALSE)
pers  <- read.csv("https://raw.githubusercontent.com/xdaiISU/ds202materials/master/hwlabs/fars2017/person.csv", stringsAsFactors = FALSE)
```

```{r}
make <- readr::read_csv("makeCodes.xls")%>%
  rename("STATE" = "Codes")
state <- readr::read_csv("stateCodes.xls") %>%
  rename("STATE" = "Codes")

##adding state and make label columns
acc2 <- right_join(state, acc)
acc_final <- right_join(make, acc2)
pers2 <- right_join(make, pers)
pers_final <- right_join(state, pers2)
acc_final
day <- readr::read_csv("dayCodes.csv")

```

1.
```{r}
##Adding day names column
acc_days <-merge(day, acc_final, by="DAY_WEEK")
acc_days %>% group_by(Day) %>% 
  summarise(total = length(Day)) %>%
  arrange(desc(total))
```
According to the data, the weekend has the most accidents, Saturday with the highest number of accidents. Friday and Sunday have similar numbers of accidents.

2.
```{r}
hurt <- pers_final[pers_final$INJ_SEV == 4,]
```

3.
```{r}
col <- pers_final[, c("INJ_SEV", "MAKE", "Make", "STATE","State", "COUNTY")]
danger <- col %>%
  filter(INJ_SEV == 4) %>%
  group_by(STATE, State, MAKE, Make) %>%
  summarize(n = n()) %>%
  group_by(STATE) %>%
  filter(n == max(n)) %>%
  filter(is.na(MAKE) == FALSE) %>%
  arrange(desc(n))
head(danger)
```

4.

5.
```{r}
joinedTables <- right_join(pers_final,acc_final)
```


6.

7.

8.
```{r}
summer <- joinedTables %>%
  filter((DAY >= 20 & MONTH >= 6) & (DAY <= 22 & MONTH <= 9)) %>%
  filter(INJ_SEV == 4 | 3) %>%
  group_by(STATE, State) %>%
  summarize(n = n()) %>%
  group_by(STATE) %>%
  filter(n == max(n)) %>%
  arrange(desc(n))
head(summer)
winter <- joinedTables %>%
  filter((DAY >= 21 & MONTH == 12) | (DAY >= 1 & MONTH >= 1) & (DAY <= 1 & MONTH <= 3)) %>%
  filter(INJ_SEV == 4 | 3) %>%
  group_by(STATE, State) %>%
  summarize(n = n()) %>%
  group_by(STATE) %>%
  filter(n == max(n)) %>%
  arrange(desc(n))
head(winter)
sums <- data.frame("Summer" = sum(summer$n), "Winter" = sum(winter$n))
sums
```
Winter seems to have more dangerous than summer when considering the number of severe accidents and suspected serious injury accidents in total. The number of these two types of accidents in each state differ, but it seems in both seasons that larger states or states with higher populations have higher frequencies.
